CODE SEGMENT
ASSUME CS:CODE, DS:CODE, ES:CODE, SS:CODE
;
PPIC_C EQU 1FH
PPIC EQU 1DH
PPIB EQU 1BH
PPIA7SEG EQU 19H
;
PORTC_C EQU 26H
PORTC EQU 24H
PORTB EQU 22H
PORTA EQU 20H
;
ORG 1000H
MOV AL, 10000000B
OUT PPIC_C, AL
;
MOV AL, 11111111B
OUT PPIA7SEG, AL
;
MOV AL, 00000000B
OUT PPIC, AL
;
MOV AL, 90H
OUT PORTC_C, AL
;
MOV BL, 0
AGAIN:
IN AL, PORTA
NOT AL
TEST AL, 00100000B
JNZ SPIN
MOV BL, 0
JMP AGAIN

SPIN:
CMP BL, 1
JE AGAIN
MOV BL, 1
MOV DL, 25
MOV AL, 01110111B
L1:
OUT PPIB, AL
CALL TIMER
ROR AL, 1
DEC DL
JNZ L1
JMP AGAIN
;

;
TIMER: MOV CX, 0FFFH
TIMER1: NOP
NOP
NOP
NOP
LOOP TIMER1
RET
;
CODE ENDS
END