        CODE   SEGMENT
        ASSUME CS:CODE,DS:CODE,ES:CODE,SS:CODE
        ;
        ;
PPI     EQU     26H 		
CPORT   EQU     24H 	
BPORT   EQU     22H	
APORT   EQU     20H
KEY	EQU	01H	
        ;


        ;
        ORG     1000H
        MOV AL, 80H
        OUT PPI, AL
        ;


AGAIN:
      CALL SCAN
      MOV AL,BYTE PTR K_BUF
      AND AX, 000FH
      MOV DL, 0FFH
      CMP AL, 0
      JE SKIP
      CMP AL, 8
      JA SKIP2
CALC1:
      SHL DL, 1
      DEC AL
      JNZ CALC1
SKIP:

      MOV AL, DL
      OUT BPORT, AL
      CALL TIMER
SKIP2:
      JMP AGAIN
        ;
        INT 3
        ;
TIMER:	MOV	CX,1000
TIMER1:	NOP
	NOP
	NOP
	NOP
	LOOP	TIMER1
	RET

SCAN:	IN	AL,KEY
	TEST	AL,10000000B
	JNZ	SCAN
	TEST	AL,00010000B
	JNZ	SCAN
	;
	AND	AL,00001111B
	MOV	BYTE PTR K_BUF,AL
	; key clear
	OUT	KEY,AL
	RET
	;
K_BUF:  DB 1


CODE ENDS
END